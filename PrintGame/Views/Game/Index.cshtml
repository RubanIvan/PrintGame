@model PrintGame.Models.GameModel

@{
//ViewBag.Title = "title";

}



<div id="game" class="clearfix">

    

    <h2 class="topic">
        @Model.TitleRu (@Model.TitleEn)
    </h2>

    <div id="GameImage">
        <div Id="Main_image">
            <img src="@Html.Raw("/Content/GameData" + @Model.GameImages.First().SmallImagePath)" alt="@Model.TitleRu" />
        </div>
        <div id="ImageList">

            <div class="nav_btn">
                <a href="javascript:{}" id="view_scroll_left" title="Другие изображения" style="cursor: pointer; opacity: 1; display: none;">Предыдущая</a>
            </div>
            <div id="Clip_panel">
                <ul>
                    @for (int i = 0; i < Model.GameImages.Count; i++)
                    {
                        <li>
                            <img src="@Html.Raw("/Content/GameData" + @Model.GameImages[i].SmallImagePath)" alt="@Model.GameImages[i].DescriptImage" />
                        </li>
                    }
                </ul>
            </div>
            <div class="nav_btn">
                <a href="javascript:{}" id="view_scroll_right" title="Другие изображения" style="cursor: pointer; opacity: 1;">Следующая</a>
            </div>
        </div>
    </div>

    <div class="gameIcon">

        @* <div class="container-fluid clearfix">*@
        <div class="clearfix">
            <div id="col_param">
                <h4>Параметры:</h4>
                <ul>
                    <li>
                        <img src="/Content/IconNumOfPlayers.png" title="Количество игроков" />
                        <span>@Model.NumOfPlayers игроков</span>
                    </li>
                    <li>
                        <img src="/Content/IconNumOfSuggested.png" title="Рекомендуемое количество игроков" />
                        <span>@Model.NumOfSuggested игроков</span>
                    </li>
                    <li>
                        <img src="/Content/IconSuggestedAges.png" title="Рекомендуемый возраст игроков от" />
                        <span>@Model.SuggestedAges лет</span>
                    </li>
                    <li>
                        <img src="/Content/IconAcquaintance.png" title="Время освоения игры" />
                        <span>@Model.Acquaintance минут</span>
                    </li>
                    <li>
                        <img src="~/Content/IconPlayingTime.png" title="Время партии" />
                        <span>@Model.PlayingTime минут</span>
                    </li>
                    <li>
                        <img src="~/Content/IconYearPublishing.png" title="Год издания" />
                        <span>@Model.YearPublishing год</span>
                    </li>
                    <li>
                        <img src="~/Content/IconRating.png" title="Средний рейтинг" />
                        <span>@Model.Rating бала</span>
                    </li>
                </ul>
            </div>
            <div id="col_consist">
                <h4>Состав&nbsp;коробки:</h4>
                <ul>
                    @Html.Raw(Model.Components)
                </ul>
            </div>
        </div>
    </div>

    <div id="ImgGall" style="display: block">

        <div id="Gall_MainImg">
            
        </div>

    </div>

</div>

@section scripts
{
    <script>
        var ImageList = new Array();
        var ImageIndex = new Object();
        ImageIndex = 0;

        //Создаем массив с картинками
        @foreach (GameImage gameImage in Model.GameImages)
        {
            @Html.Raw("ImageList.push({" + $" \"GameImageID \": {gameImage.GameImageID}, " +
                      $"\"FulllImagePath\": \"/Content/GameData{gameImage.FulllImagePath}\" , " +
                      $"\"SmallImagePath\": \"/Content/GameData{gameImage.SmallImagePath}\" , " +
                      $"\"DescriptImage\": \"{gameImage.DescriptImage}\" " + "});\n")
            ;

        }

        //Прокрутка в право (обработчик нажатия)
        $("#view_scroll_right").click(function() {
            ImageIndex++;

            if (ImageIndex == ImageList.length - 3) {
                $("#view_scroll_right").hide();
            }
            $("#view_scroll_left").show();

            $("#ImageList ul").animate({ marginLeft: "-=90px" }, 700, "swing");

        });

        //Прокрутка в лево
        $("#view_scroll_left").click(function() {
            ImageIndex--;

            if (ImageIndex == 0) {
                $("#view_scroll_left").hide();

            }
            $("#view_scroll_right").show();

            $("#ImageList ul").animate({ marginLeft: "+=90px" }, 700, "swing");


        });

        //Наведение на картинку
        $("#ImageList ul img").hover(function() {

            for (var i = 0; i < ImageList.length; i++) {
                if (ImageList[i].SmallImagePath == $(this).attr("src")) {
                    $("#Main_image img").attr({ src: ImageList[i].SmallImagePath });
                }
            }
        });

//------------------------- Просмотр галереи -----------------------------------

        var url = ImageList[0].FulllImagePath;

        var image = $("<img />");

        $(image).load(function() { alert("complite") });

        $.ajax({
            url: url,
            cache: false,
            processData: false
        }).always(function() {

            image.attr("src", url);
            $("#Gall_MainImg").append(image).fadeIn();

        });

        //$.when(img).done(function () { alert("complite") });

    </script>
}    